{% extends 'base.html' %}
{% load dict_get %}
{% block content %}

<h2>Your Habits</h2>

<form method="post">
    {% csrf_token %}
    <div class="form-row mb-3">
        {{ form.name }}
        <button type="submit" name="add_habit" class="btn btn-primary ml-2">Add Habit</button>
    </div>

    <table class="table table-bordered">
        <thead class="thead-light">
            <tr>
                <th>Habit</th>
                {% for day in days %}
                    <th>{{ day.day }}</th>  {# keep day.day if day is an object with a day attribute #}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for habit in habits %}
                <tr>
                    <td>{{ habit.name }}</td>
                    {% for day in days %}
                        <td>
                            <input type="checkbox" name="{{ habit.id }}_{{ day.day }}" 
                            {% if status and status|dict_get:habit.id and status|dict_get:habit.id|dict_get:day.day %}checked{% endif %}>
                        </td>
                    {% endfor %}
                </tr>
            {% empty %}
                <tr><td colspan="{{ days|length|add:'1' }}">No habits yet.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <button type="submit" name="update_status" class="btn btn-success">Update Status</button>
</form>

{% endblock %}
